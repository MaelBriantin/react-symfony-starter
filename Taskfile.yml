version: "3"

vars:
  DOCKER_COMPOSE: docker-compose
  DOCKER_RUN: "{{.DOCKER_COMPOSE}} run --rm"

includes:
  caddy: ./tasks/caddy.yml
  mysql:
    taskfile: ./tasks/mysql.yml
    aliases: [db, database]
  deno:
    taskfile: ./tasks/deno.yml
    aliases: [client, react]
  docker:
    taskfile: ./tasks/docker.yml
    aliases: [dc]
  php: 
    taskfile: ./tasks/php.yml
    aliases: [api, symfony]
  tools:
    taskfile: ./tasks/tools.yml

dotenv: [.env]

set: [pipefail]
output: prefixed

tasks:
  default:
    cmds:
      - echo "Enter 'task --list' to see all available tasks"
    silent: true

  install:
    desc: Initialize the complete stack
    cmds:
      - task: tools:env
      - task: mysql
      - task: php
      - task: deno
      - task: caddy
      - echo "✨ Installation complete! ✨"
    silent: true
