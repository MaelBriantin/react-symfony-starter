version: "3"

vars:
  DOCKER_COMPOSE: docker-compose
  DOCKER_RUN: "{{.DOCKER_COMPOSE}} run --rm"

includes:
  caddy: ./tasks/caddy.yml
  database:
    taskfile: ./tasks/database.yml
    aliases: [db]
  docker:
    taskfile: ./tasks/docker.yml
    aliases: [dc]
  php: ./tasks/php.yml
  react: ./tasks/react.yml
  tools:
    taskfile: ./tasks/tools.yml

dotenv: [.env]

set: [pipefail]
output: prefixed

tasks:
  default:
    cmds:
      - echo "Enter 'task --list' to see all available tasks"
    silent: true

  install:
    desc: Initialize the complete stack
    cmds:
      - task: tools:env
      - task: database:init
      - task: php:init
      - task: react:init
      - task: caddy:init
      - echo "✨ Installation complete! ✨"
    silent: true
